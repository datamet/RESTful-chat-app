var app=function(){"use strict";function e(){}const t=e=>e;function n(e){return e()}function s(){return Object.create(null)}function o(e){e.forEach(n)}function r(e){return"function"==typeof e}function a(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function i(t,n,s){t.$$.on_destroy.push(function(t,...n){if(null==t)return e;const s=t.subscribe(...n);return s.unsubscribe?()=>s.unsubscribe():s}(n,s))}function l(e,t,n,s){return e[1]&&s?function(e,t){for(const n in t)e[n]=t[n];return e}(n.ctx.slice(),e[1](s(t))):n.ctx}function c(e,t,n,s,o,r,a){const i=function(e,t,n,s){if(e[2]&&s){const o=e[2](s(n));if(void 0===t.dirty)return o;if("object"==typeof o){const e=[],n=Math.max(t.dirty.length,o.length);for(let s=0;s<n;s+=1)e[s]=t.dirty[s]|o[s];return e}return t.dirty|o}return t.dirty}(t,s,o,r);if(i){const o=l(t,n,s,a);e.p(o,i)}}function u(e){return null==e?"":e}const d="undefined"!=typeof window;let m=d?()=>window.performance.now():()=>Date.now(),h=d?e=>requestAnimationFrame(e):e;const f=new Set;function p(e){f.forEach((t=>{t.c(e)||(f.delete(t),t.f())})),0!==f.size&&h(p)}function g(e){let t;return 0===f.size&&h(p),{promise:new Promise((n=>{f.add(t={c:e,f:n})})),abort(){f.delete(t)}}}function $(e,t){e.appendChild(t)}function y(e,t,n){e.insertBefore(t,n||null)}function b(e){e.parentNode.removeChild(e)}function v(e){return document.createElement(e)}function w(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function x(e){return document.createTextNode(e)}function k(){return x(" ")}function M(){return x("")}function I(e,t,n,s){return e.addEventListener(t,n,s),()=>e.removeEventListener(t,n,s)}function _(e){return function(t){return t.stopPropagation(),e.call(this,t)}}function D(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function C(e,t,n){e.setAttributeNS("http://www.w3.org/1999/xlink",t,n)}function S(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function T(e,t){e.value=null==t?"":t}const j=new Set;let R,O=0;function E(e,t,n,s,o,r,a,i=0){const l=16.666/s;let c="{\n";for(let e=0;e<=1;e+=l){const s=t+(n-t)*r(e);c+=100*e+`%{${a(s,1-s)}}\n`}const u=c+`100% {${a(n,1-n)}}\n}`,d=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(u)}_${i}`,m=e.ownerDocument;j.add(m);const h=m.__svelte_stylesheet||(m.__svelte_stylesheet=m.head.appendChild(v("style")).sheet),f=m.__svelte_rules||(m.__svelte_rules={});f[d]||(f[d]=!0,h.insertRule(`@keyframes ${d} ${u}`,h.cssRules.length));const p=e.style.animation||"";return e.style.animation=`${p?`${p}, `:""}${d} ${s}ms linear ${o}ms 1 both`,O+=1,d}function q(e,t){const n=(e.style.animation||"").split(", "),s=n.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),o=n.length-s.length;o&&(e.style.animation=s.join(", "),O-=o,O||h((()=>{O||(j.forEach((e=>{const t=e.__svelte_stylesheet;let n=t.cssRules.length;for(;n--;)t.deleteRule(n);e.__svelte_rules={}})),j.clear())})))}function P(e){R=e}function z(){if(!R)throw new Error("Function called outside component initialization");return R}function U(e){z().$$.on_mount.push(e)}function N(e){z().$$.on_destroy.push(e)}function H(e,t){z().$$.context.set(e,t)}function A(e){return z().$$.context.get(e)}function L(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach((e=>e(t)))}const B=[],F=[],W=[],G=[],J=Promise.resolve();let Y=!1;function K(e){W.push(e)}let Q=!1;const V=new Set;function X(){if(!Q){Q=!0;do{for(let e=0;e<B.length;e+=1){const t=B[e];P(t),Z(t.$$)}for(P(null),B.length=0;F.length;)F.pop()();for(let e=0;e<W.length;e+=1){const t=W[e];V.has(t)||(V.add(t),t())}W.length=0}while(B.length);for(;G.length;)G.pop()();Y=!1,Q=!1,V.clear()}}function Z(e){if(null!==e.fragment){e.update(),o(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(K)}}let ee;function te(){return ee||(ee=Promise.resolve(),ee.then((()=>{ee=null}))),ee}function ne(e,t,n){e.dispatchEvent(function(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}(`${t?"intro":"outro"}${n}`))}const se=new Set;let oe;function re(){oe={r:0,c:[],p:oe}}function ae(){oe.r||o(oe.c),oe=oe.p}function ie(e,t){e&&e.i&&(se.delete(e),e.i(t))}function le(e,t,n,s){if(e&&e.o){if(se.has(e))return;se.add(e),oe.c.push((()=>{se.delete(e),s&&(n&&e.d(1),s())})),e.o(t)}}const ce={duration:0};function ue(e,t){le(e,1,1,(()=>{t.delete(e.key)}))}function de(e,t,n,s,o,r,a,i,l,c,u,d){let m=e.length,h=r.length,f=m;const p={};for(;f--;)p[e[f].key]=f;const g=[],$=new Map,y=new Map;for(f=h;f--;){const e=d(o,r,f),i=n(e);let l=a.get(i);l?s&&l.p(e,t):(l=c(i,e),l.c()),$.set(i,g[f]=l),i in p&&y.set(i,Math.abs(f-p[i]))}const b=new Set,v=new Set;function w(e){ie(e,1),e.m(i,u),a.set(e.key,e),u=e.first,h--}for(;m&&h;){const t=g[h-1],n=e[m-1],s=t.key,o=n.key;t===n?(u=t.first,m--,h--):$.has(o)?!a.has(s)||b.has(s)?w(t):v.has(o)?m--:y.get(s)>y.get(o)?(v.add(s),w(t)):(b.add(o),m--):(l(n,a),m--)}for(;m--;){const t=e[m];$.has(t.key)||l(t,a)}for(;h;)w(g[h-1]);return g}function me(e){e&&e.c()}function he(e,t,s,a){const{fragment:i,on_mount:l,on_destroy:c,after_update:u}=e.$$;i&&i.m(t,s),a||K((()=>{const t=l.map(n).filter(r);c?c.push(...t):o(t),e.$$.on_mount=[]})),u.forEach(K)}function fe(e,t){const n=e.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function pe(e,t){-1===e.$$.dirty[0]&&(B.push(e),Y||(Y=!0,J.then(X)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function ge(t,n,r,a,i,l,c=[-1]){const u=R;P(t);const d=t.$$={fragment:null,ctx:null,props:l,update:e,not_equal:i,bound:s(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(u?u.$$.context:n.context||[]),callbacks:s(),dirty:c,skip_bound:!1};let m=!1;if(d.ctx=r?r(t,n.props||{},((e,n,...s)=>{const o=s.length?s[0]:n;return d.ctx&&i(d.ctx[e],d.ctx[e]=o)&&(!d.skip_bound&&d.bound[e]&&d.bound[e](o),m&&pe(t,e)),n})):[],d.update(),m=!0,o(d.before_update),d.fragment=!!a&&a(d.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);d.fragment&&d.fragment.l(e),e.forEach(b)}else d.fragment&&d.fragment.c();n.intro&&ie(t.$$.fragment),he(t,n.target,n.anchor,n.customElement),X()}P(u)}class $e{$destroy(){fe(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const ye=[];function be(t,n=e){let s;const o=[];function r(e){if(a(t,e)&&(t=e,s)){const e=!ye.length;for(let e=0;e<o.length;e+=1){const n=o[e];n[1](),ye.push(n,t)}if(e){for(let e=0;e<ye.length;e+=2)ye[e][0](ye[e+1]);ye.length=0}}}return{set:r,update:function(e){r(e(t))},subscribe:function(a,i=e){const l=[a,i];return o.push(l),1===o.length&&(s=n(r)||e),a(t),()=>{const e=o.indexOf(l);-1!==e&&o.splice(e,1),0===o.length&&(s(),s=null)}}}}const ve=function(){const e=localStorage.getItem("auth")?localStorage.getItem("auth"):"",{subscribe:t,set:n,update:s}=be(e);return{subscribe:t,set:e=>{n(e),localStorage.setItem("auth",e)}}}();const we=function(){const e=localStorage.getItem("user")?localStorage.getItem("user"):"",{subscribe:t,set:n,update:s}=be(e);return{subscribe:t,set:e=>{n(e),localStorage.setItem("user",e)}}}(),xe=be(null);var ke=()=>{const e=[],t=(e=>t=>{const n={path:t.path||"/",method:t.method||"GET",headers:t.headers||{},body:t.body||{}},s=[...e];return new Promise(((e,t)=>{const o={status:200,body:{},err:e=>{t(e)},end:()=>{e({status:o.status,body:o.body})}},r=e=>{if(!e){const e=s.shift();e&&e(n,o,r)}};r()}))})(e);return{use:t=>e.push(t),post:(e,n)=>t({path:e,method:"POST",...n}),get:(e,n)=>t({path:e,method:"GET",...n}),put:(e,n)=>t({path:e,method:"PUT",...n}),delete:(e,n)=>t({path:e,method:"DELETE",...n})}};let Me;Me="object"==typeof process?"node":"browser";const Ie={env:Me,push:"node"===Me&&process.env.PUSH||!0,host:"node"===Me&&process.env.HOST||"localhost",port:"node"===Me&&process.env.PORT||5e3,wsport:"node"===Me&&process.env.WS_PORT||5050};class _e{state;subscribers;constructor(){this.state={},this.subscribers=[]}get(){return{...this.state}}update(e){this.state={...this.state,...e};for(const e of this.subscribers)e({...this.state})}subscribe(e){return this.subscribers.push(e),()=>this.subscribers.splice(this.subscribers.indexOf(e),1)}}const De=async(e,t,n)=>{try{t(await e())}catch(e){console.log("Error while fetching. Stopping"),console.log(e),errCallback&&errCallback(),n()}};class Ce{subs;started;constructor(){this.subs=new Map,this.started=!1,this.createStopper=e=>()=>{this.subs.delete(e),clearInterval(e)},this.add=(e,t,n,s)=>{const o=setInterval((()=>{this.started&&De(t,n,this.createStopper(o))}),e);return this.subs.set(o,{interval:e,func:t,callback:n,errCallback:s}),this.createStopper(o)},this.update=()=>{for(const[e,{func:t,callback:n,errCallback:s}]of this.subs)De(t,n,this.createStopper(e))}}}var Se="browser"===Ie.env?(e,{update:t,state:n})=>{let s,o=t;n.subscribe((({token:t})=>{t&&!s?(s=(e=>{const t=new WebSocket(e);return t.onerror=e=>{console.log(e),t.close()},t})(e),s.onopen=()=>s.send(t),s.onmessage=e=>{o()}):!t&&s&&(s.close(),s=null)}))}:(e,{SocketModule:t,update:n,state:s})=>{let o,r=n;s.subscribe((({token:n})=>{n&&!o?(o=((e,t)=>{const n=new t(e);return n.on("error",(e=>{console.log(e),n.close()})),n})(e,t),o.on("open",(()=>o.send(n))),o.on("message",(e=>{r()}))):!n&&o&&(o.close(),o=null)}))},Te=(e,t,n)=>{"POST"!==e.method&&"PUT"!==e.method||(e.headers["Content-Type"]="application/json"),n()};let je,Re;const Oe=async(e,t,n)=>{try{const{path:s,method:o,headers:r,body:a}=e,i=je.port?`http://${je.host}:${je.port}${s}`:`http://${je.host}${s}`,l=await fetch(i,{method:o,headers:r,body:"POST"===o||"PUT"==o?JSON.stringify(a):null});if("application/json; charset=utf-8"===l.headers.get("Content-Type")){const e=await l.json();t.status=l.status,t.body=e}else console.log(await l.text());n()}catch(e){t.status=408,t.body={error:"Could not connect to the server"},n()}},Ee=async(e,t,n)=>{try{const{path:s,method:o,headers:r,body:a}=e,i=JSON.stringify(a),l={hostname:je.host,port:je.port,path:s,method:o,headers:{...r,"Content-Length":i.length}},c=Re.request(l,(e=>{t.status=e.statusCode;let s="";e.on("data",(e=>{s+=e})),e.on("end",(()=>{const e=JSON.parse(s);t.body=e,n()}))}));c.on("error",(e=>{console.error(e)})),c.write(i),c.end()}catch(e){t.status=408,t.body={error:"Could not connect to the server"},n()}};var qe="browser"===Ie.env?e=>(je=e,Oe):(e,t)=>(Re=t,je=e,Ee);var Pe=(e,t,n)=>{if(!t&&"node"===Ie.env)throw new Error("Http module is required as input when running in node");"object"==typeof e&&Object.assign(Ie,e);const s=ke(),o=new _e;s.use((e=>(t,n,s)=>{if(("/api/users"===t.path||"/api/tokens"===t.path)&&"POST"===t.method)return void s();const{token:o}=e.get();o&&"string"==typeof o&&(t.headers.Token=o),s()})(o)),s.use(Te),s.use(qe(Ie,t)),s.use((e=>(t,n,s)=>{n.body.token&&"string"==typeof n.body.token&&e.update({token:n.body.token}),n.body.message&&"Logged out"===n.body.message&&e.update({token:null,userID:null}),n.body.message&&"User deleted"===n.body.message&&e.update({token:null,userID:null}),n.body.error&&"Session not found"===n.body.error&&e.update({token:null,userID:null}),n.body.userID&&"string"==typeof n.body.userID&&e.update({userID:n.body.userID}),n.end()})(o));const r=(a=s,{register:(e,t)=>a.post("/api/users",{body:{username:e,password:t}}),registerBot:(e,t)=>a.post("/api/users",{body:{username:e,password:t,bot:!0}}),getUsers:()=>a.get("/api/users"),getUser:e=>a.get(`/api/user/${e}`),deleteUser:e=>a.delete(`/api/user/${e}`),login:(e,t)=>a.post("/api/tokens",{body:{username:e,password:t}}),getTokens:()=>a.get("/api/tokens"),extendToken:e=>a.post(`/api/token/${e}`),logout:e=>a.delete(`/api/token/${e}`),createRoom:e=>a.post("/api/rooms",{body:{name:e}}),getRooms:()=>a.get("/api/rooms"),getRoom:e=>a.get(`/api/room/${e}`),deleteRoom:e=>a.delete(`/api/room/${e}`),joinRoom:(e,t)=>a.post(`/api/room/${e}/users`,{body:{user:t}}),getUsersInRoom:e=>a.get(`/api/room/${e}/users`),getMessages:e=>a.get(`/api/room/${e}/messages`),postMessage:(e,t,n)=>a.post(`/api/room/${e}/${t}/messages`,{body:{message:n}}),getMessagesFromUser:(e,t)=>a.get(`/room/${e}/${t}/messages`),checkPush:()=>a.get("/api/push")});var a;return r.state=o,r.fresh=new Ce,Se(`ws://${Ie.host}:${Ie.wsport}`,{SocketModule:n,update:r.fresh.update,state:o}),(async e=>{"disabled"!==(await e.checkPush()).body.push&&Ie.push||e.fresh.start()})(r),r};function ze(t){let n,s,o,r,a;return{c(){n=w("svg"),s=w("use"),o=k(),r=w("symbol"),a=w("path"),C(s,"xlink:href","#icon-bubbles"),D(n,"class","icon icon-bubbles svelte-1m14we6"),D(a,"d","M34 28.161c0 1.422 0.813 2.653 2 3.256v0.498c-0.332 0.045-0.671 0.070-1.016 0.070-2.125 0-4.042-0.892-5.398-2.321-0.819 0.218-1.688 0.336-2.587 0.336-4.971 0-9-3.582-9-8s4.029-8 9-8c4.971 0 9 3.582 9 8 0 1.73-0.618 3.331-1.667 4.64-0.213 0.463-0.333 0.979-0.333 1.522zM16 0c8.702 0 15.781 5.644 15.995 12.672-1.537-0.685-3.237-1.047-4.995-1.047-2.986 0-5.807 1.045-7.942 2.943-2.214 1.968-3.433 4.607-3.433 7.432 0 1.396 0.298 2.747 0.867 3.993-0.163 0.004-0.327 0.007-0.492 0.007-0.849 0-1.682-0.054-2.495-0.158-3.437 3.437-7.539 4.053-11.505 4.144v-0.841c2.142-1.049 4-2.961 4-5.145 0-0.305-0.024-0.604-0.068-0.897-3.619-2.383-5.932-6.024-5.932-10.103 0-7.18 7.163-13 16-13z"),D(r,"id","icon-bubbles"),D(r,"viewBox","0 0 36 32")},m(e,t){y(e,n,t),$(n,s),y(e,o,t),y(e,r,t),$(r,a)},p:e,i:e,o:e,d(e){e&&b(n),e&&b(o),e&&b(r)}}}class Ue extends $e{constructor(e){super(),ge(this,e,null,ze,a,{})}}function Ne(e,{delay:n=0,duration:s=400,easing:o=t}={}){const r=+getComputedStyle(e).opacity;return{delay:n,duration:s,easing:o,css:e=>"opacity: "+e*r}}function He(t){let n,s,o,r,a;return{c(){n=w("svg"),s=w("use"),o=k(),r=w("symbol"),a=w("path"),C(s,"xlink:href","#icon-cross"),D(n,"class","icon icon-cross svelte-1qil70w"),D(a,"d","M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"),D(r,"id","icon-cross"),D(r,"viewBox","0 0 20 20")},m(e,t){y(e,n,t),$(n,s),y(e,o,t),y(e,r,t),$(r,a)},p:e,i:e,o:e,d(e){e&&b(n),e&&b(o),e&&b(r)}}}class Ae extends $e{constructor(e){super(),ge(this,e,null,He,a,{})}}function Le(e){let t,n,s,o,a;const i=e[3].default,d=function(e,t,n,s){if(e){const o=l(e,t,n,s);return e[0](o)}}(i,e,e[2],null);return{c(){t=v("button"),d&&d.c(),D(t,"class",n=u(e[1])+" svelte-1llkmww")},m(n,i){y(n,t,i),d&&d.m(t,null),s=!0,o||(a=I(t,"click",(function(){r(e[0])&&e[0].apply(this,arguments)})),o=!0)},p(o,[r]){e=o,d&&d.p&&4&r&&c(d,i,e,e[2],r,null,null),(!s||2&r&&n!==(n=u(e[1])+" svelte-1llkmww"))&&D(t,"class",n)},i(e){s||(ie(d,e),s=!0)},o(e){le(d,e),s=!1},d(e){e&&b(t),d&&d.d(e),o=!1,a()}}}function Be(e,t,n){let{$$slots:s={},$$scope:o}=t,{action:r=(()=>{})}=t,{color:a="blue"}=t;return e.$$set=e=>{"action"in e&&n(0,r=e.action),"color"in e&&n(1,a=e.color),"$$scope"in e&&n(2,o=e.$$scope)},[r,a,o,s]}class Fe extends $e{constructor(e){super(),ge(this,e,Be,Le,a,{action:0,color:1})}}function We(e){let t;return{c(){t=x(e[0])},m(e,n){y(e,t,n)},p(e,n){1&n&&S(t,e[0])},d(e){e&&b(t)}}}function Ge(n){let s,a,i,l,c,u,d,h,f,p,w,M,C,j,R,O,P,z,U,N,H,A,L,B,F,W,G,J,Y;return l=new Ae({}),B=new Fe({props:{action:n[5],$$slots:{default:[Je]},$$scope:{ctx:n}}}),{c(){s=v("div"),a=v("div"),i=v("button"),me(l.$$.fragment),c=k(),u=v("h3"),d=x(n[0]),h=k(),f=v("form"),p=v("div"),w=v("label"),w.textContent="Username:",M=k(),C=v("input"),j=k(),R=v("div"),O=v("label"),O.textContent="Password:",P=k(),z=v("input"),U=k(),N=v("div"),H=v("p"),A=x(n[2]),L=k(),me(B.$$.fragment),D(i,"class","cross svelte-bjlt99"),D(w,"for","username"),D(C,"id","username"),D(C,"type","text"),D(p,"class","form-group"),D(O,"for","password"),D(z,"id","password"),D(z,"type","password"),D(R,"class","form-group"),D(N,"class","error svelte-bjlt99"),D(f,"class","form svelte-bjlt99"),D(a,"class","modal svelte-bjlt99"),D(s,"class","background svelte-bjlt99")},m(e,t){var o;y(e,s,t),$(s,a),$(a,i),he(l,i,null),$(a,c),$(a,u),$(u,d),$(a,h),$(a,f),$(f,p),$(p,w),$(p,M),$(p,C),T(C,n[3]),$(f,j),$(f,R),$(R,O),$(R,P),$(R,z),T(z,n[4]),$(f,U),$(f,N),$(N,H),$(H,A),$(f,L),he(B,f,null),G=!0,J||(Y=[I(i,"click",n[9]),I(C,"input",n[10]),I(z,"input",n[11]),I(f,"submit",(o=n[7],function(e){return e.preventDefault(),o.call(this,e)})),I(a,"click",_(n[6])),I(s,"click",n[12])],J=!0)},p(e,t){(!G||1&t)&&S(d,e[0]),8&t&&C.value!==e[3]&&T(C,e[3]),16&t&&z.value!==e[4]&&T(z,e[4]),(!G||4&t)&&S(A,e[2]);const n={};65537&t&&(n.$$scope={dirty:t,ctx:e}),B.$set(n)},i(n){G||(ie(l.$$.fragment,n),ie(B.$$.fragment,n),K((()=>{W&&W.end(1),F||(F=function(n,s,o){let a,i,l=s(n,o),c=!1,u=0;function d(){a&&q(n,a)}function h(){const{delay:s=0,duration:o=300,easing:r=t,tick:h=e,css:f}=l||ce;f&&(a=E(n,0,1,o,s,r,f,u++)),h(0,1);const p=m()+s,$=p+o;i&&i.abort(),c=!0,K((()=>ne(n,!0,"start"))),i=g((e=>{if(c){if(e>=$)return h(1,0),ne(n,!0,"end"),d(),c=!1;if(e>=p){const t=r((e-p)/o);h(t,1-t)}}return c}))}let f=!1;return{start(){f||(q(n),r(l)?(l=l(),te().then(h)):h())},invalidate(){f=!1},end(){c&&(d(),c=!1)}}}(s,Ne,{duration:200})),F.start()})),G=!0)},o(n){le(l.$$.fragment,n),le(B.$$.fragment,n),F&&F.invalidate(),W=function(n,s,a){let i,l=s(n,a),c=!0;const u=oe;function d(){const{delay:s=0,duration:r=300,easing:a=t,tick:d=e,css:h}=l||ce;h&&(i=E(n,1,0,r,s,a,h));const f=m()+s,p=f+r;K((()=>ne(n,!1,"start"))),g((e=>{if(c){if(e>=p)return d(0,1),ne(n,!1,"end"),--u.r||o(u.c),!1;if(e>=f){const t=a((e-f)/r);d(1-t,t)}}return c}))}return u.r+=1,r(l)?te().then((()=>{l=l(),d()})):d(),{end(e){e&&l.tick&&l.tick(1,0),c&&(i&&q(n,i),c=!1)}}}(s,Ne,{duration:200}),G=!1},d(e){e&&b(s),fe(l),fe(B),e&&W&&W.end(),J=!1,o(Y)}}}function Je(e){let t;return{c(){t=x(e[0])},m(e,n){y(e,t,n)},p(e,n){1&n&&S(t,e[0])},d(e){e&&b(t)}}}function Ye(e){let t,n,s,o;n=new Fe({props:{action:e[8],$$slots:{default:[We]},$$scope:{ctx:e}}});let r=e[1]&&Ge(e);return{c(){t=v("div"),me(n.$$.fragment),s=k(),r&&r.c(),D(t,"class","dropdown svelte-bjlt99")},m(e,a){y(e,t,a),he(n,t,null),$(t,s),r&&r.m(t,null),o=!0},p(e,[s]){const o={};2&s&&(o.action=e[8]),65537&s&&(o.$$scope={dirty:s,ctx:e}),n.$set(o),e[1]?r?(r.p(e,s),2&s&&ie(r,1)):(r=Ge(e),r.c(),ie(r,1),r.m(t,null)):r&&(re(),le(r,1,1,(()=>{r=null})),ae())},i(e){o||(ie(n.$$.fragment,e),ie(r),o=!0)},o(e){le(n.$$.fragment,e),le(r),o=!1},d(e){e&&b(t),fe(n),r&&r.d()}}}function Ke(e,t,n){let s,o,{action:r="Register"}=t,a=!1,i="",l=A("client");const c=async()=>await l.login(s,o),u=async()=>{const e=await l.register(s,o);return e.body.message&&c(),e};return e.$$set=e=>{"action"in e&&n(0,r=e.action)},[r,a,i,s,o,async()=>{const e="Register"===r?u:c;let t=await e();t.body.error&&n(2,i=t.body.error),t.body.message&&(n(1,a=!1),n(2,i=""),n(3,s=""),n(4,o=""))},function(t){L(e,t)},function(t){L(e,t)},()=>n(1,a=!0),()=>n(1,a=!1),function(){s=this.value,n(3,s)},function(){o=this.value,n(4,o)},()=>n(1,a=!1)]}class Qe extends $e{constructor(e){super(),ge(this,e,Ke,Ye,a,{action:0})}}function Ve(t){let n,s,o;return{c(){n=v("p"),s=x("You are logged in as "),o=x(t[0]),D(n,"class","svelte-12r322e")},m(e,t){y(e,n,t),$(n,s),$(n,o)},p(e,[t]){1&t&&S(o,e[0])},i:e,o:e,d(e){e&&b(n)}}}function Xe(e,t,n){let s;i(e,we,(e=>n(1,s=e)));const o=A("client");let r="";return(async()=>{const e=await o.getUser(s);e.body.user&&n(0,r=e.body.user.username)})(),[r]}class Ze extends $e{constructor(e){super(),ge(this,e,Xe,Ve,a,{})}}function et(e){let t,n,s,o,r,a;return n=new Ze({}),r=new Fe({props:{action:e[2],$$slots:{default:[nt]},$$scope:{ctx:e}}}),{c(){t=v("li"),me(n.$$.fragment),s=k(),o=v("li"),me(r.$$.fragment)},m(e,i){y(e,t,i),he(n,t,null),y(e,s,i),y(e,o,i),he(r,o,null),a=!0},p(e,t){const n={};16&t&&(n.$$scope={dirty:t,ctx:e}),r.$set(n)},i(e){a||(ie(n.$$.fragment,e),ie(r.$$.fragment,e),a=!0)},o(e){le(n.$$.fragment,e),le(r.$$.fragment,e),a=!1},d(e){e&&b(t),fe(n),e&&b(s),e&&b(o),fe(r)}}}function tt(t){let n,s,o,r,a,i;return s=new Qe({props:{action:"Login"}}),a=new Qe({props:{action:"Register"}}),{c(){n=v("li"),me(s.$$.fragment),o=k(),r=v("li"),me(a.$$.fragment)},m(e,t){y(e,n,t),he(s,n,null),y(e,o,t),y(e,r,t),he(a,r,null),i=!0},p:e,i(e){i||(ie(s.$$.fragment,e),ie(a.$$.fragment,e),i=!0)},o(e){le(s.$$.fragment,e),le(a.$$.fragment,e),i=!1},d(e){e&&b(n),fe(s),e&&b(o),e&&b(r),fe(a)}}}function nt(e){let t;return{c(){t=x("Logout")},m(e,n){y(e,t,n)},d(e){e&&b(t)}}}function st(e){let t,n,s,o,r,a,i,l,c,u,d,m,h,f,p,g=(e[1]?e[1].name:"")+"";s=new Ue({});const w=[tt,et],M=[];function I(e,t){return e[0]?1:0}return h=I(e),f=M[h]=w[h](e),{c(){t=v("header"),n=v("div"),me(s.$$.fragment),o=k(),r=v("h1"),r.textContent="ChatApp",a=k(),i=v("div"),l=v("h2"),c=x(g),u=k(),d=v("nav"),m=v("ul"),f.c(),D(r,"class","svelte-g75w2"),D(n,"class","logo svelte-g75w2"),D(l,"class","svelte-g75w2"),D(i,"class","room-title"),D(m,"class","svelte-g75w2"),D(t,"class","svelte-g75w2")},m(e,f){y(e,t,f),$(t,n),he(s,n,null),$(n,o),$(n,r),$(t,a),$(t,i),$(i,l),$(l,c),$(t,u),$(t,d),$(d,m),M[h].m(m,null),p=!0},p(e,[t]){(!p||2&t)&&g!==(g=(e[1]?e[1].name:"")+"")&&S(c,g);let n=h;h=I(e),h===n?M[h].p(e,t):(re(),le(M[n],1,1,(()=>{M[n]=null})),ae(),f=M[h],f?f.p(e,t):(f=M[h]=w[h](e),f.c()),ie(f,1),f.m(m,null))},i(e){p||(ie(s.$$.fragment,e),ie(f),p=!0)},o(e){le(s.$$.fragment,e),le(f),p=!1},d(e){e&&b(t),fe(s),M[h].d()}}}function ot(e,t,n){let s,o;i(e,ve,(e=>n(0,s=e))),i(e,xe,(e=>n(1,o=e)));const r=A("client");return[s,o,async()=>{await r.logout(s)}]}class rt extends $e{constructor(e){super(),ge(this,e,ot,st,a,{})}}function at(t){let n,s,o,r,a;return{c(){n=w("svg"),s=w("use"),o=k(),r=w("symbol"),a=w("path"),C(s,"xlink:href","#icon-home"),D(n,"class","icon icon-home svelte-8idrmo"),D(a,"d","M18.672 11h-1.672v6c0 0.445-0.194 1-1 1h-4v-6h-4v6h-4c-0.806 0-1-0.555-1-1v-6h-1.672c-0.598 0-0.47-0.324-0.060-0.748l8.024-8.032c0.195-0.202 0.451-0.302 0.708-0.312 0.257 0.010 0.513 0.109 0.708 0.312l8.023 8.031c0.411 0.425 0.539 0.749-0.059 0.749z"),D(r,"id","icon-home"),D(r,"viewBox","0 0 20 20")},m(e,t){y(e,n,t),$(n,s),y(e,o,t),y(e,r,t),$(r,a)},p:e,i:e,o:e,d(e){e&&b(n),e&&b(o),e&&b(r)}}}class it extends $e{constructor(e){super(),ge(this,e,null,at,a,{})}}function lt(e,t,n){const s=e.slice();return s[16]=t[n],s}function ct(e,t,n){const s=e.slice();return s[16]=t[n],s}function ut(t){let n;return{c(){n=v("p"),n.textContent="You haven't joined any rooms",D(n,"class","placeholder svelte-13qkdxs")},m(e,t){y(e,n,t)},p:e,i:e,o:e,d(e){e&&b(n)}}}function dt(e){let t,n,s=[],o=new Map,r=e[0];const a=e=>e[16].id;for(let t=0;t<r.length;t+=1){let n=ct(e,r,t),i=a(n);o.set(i,s[t]=mt(i,n))}return{c(){for(let e=0;e<s.length;e+=1)s[e].c();t=M()},m(e,o){for(let t=0;t<s.length;t+=1)s[t].m(e,o);y(e,t,o),n=!0},p(e,n){261&n&&(r=e[0],re(),s=de(s,n,a,1,e,r,o,t.parentNode,ue,mt,t,ct),ae())},i(e){if(!n){for(let e=0;e<r.length;e+=1)ie(s[e]);n=!0}},o(e){for(let e=0;e<s.length;e+=1)le(s[e]);n=!1},d(e){for(let t=0;t<s.length;t+=1)s[t].d(e);e&&b(t)}}}function mt(e,t){let n,s,o,r,a,i,l,c,u,d,m,h,f=t[16].name+"";function p(){return t[9](t[16])}return r=new it({}),{key:e,first:null,c(){n=v("button"),s=v("div"),o=v("div"),me(r.$$.fragment),a=k(),i=v("h3"),l=x(f),u=k(),D(i,"class","room-name svelte-13qkdxs"),D(o,"class","room-title svelte-13qkdxs"),D(s,"class",c="room "+(t[16].id===t[2]?"selected":"")+" svelte-13qkdxs"),D(n,"class","room-button svelte-13qkdxs"),this.first=n},m(e,t){y(e,n,t),$(n,s),$(s,o),he(r,o,null),$(o,a),$(o,i),$(i,l),$(n,u),d=!0,m||(h=I(n,"click",p),m=!0)},p(e,n){t=e,(!d||1&n)&&f!==(f=t[16].name+"")&&S(l,f),(!d||5&n&&c!==(c="room "+(t[16].id===t[2]?"selected":"")+" svelte-13qkdxs"))&&D(s,"class",c)},i(e){d||(ie(r.$$.fragment,e),d=!0)},o(e){le(r.$$.fragment,e),d=!1},d(e){e&&b(n),fe(r),m=!1,h()}}}function ht(t){let n;return{c(){n=v("p"),n.textContent="There are no rooms you haven't joined",D(n,"class","placeholder svelte-13qkdxs")},m(e,t){y(e,n,t)},p:e,i:e,o:e,d(e){e&&b(n)}}}function ft(e){let t,n,s=[],o=new Map,r=e[1];const a=e=>e[16].id;for(let t=0;t<r.length;t+=1){let n=lt(e,r,t),i=a(n);o.set(i,s[t]=pt(i,n))}return{c(){for(let e=0;e<s.length;e+=1)s[e].c();t=M()},m(e,o){for(let t=0;t<s.length;t+=1)s[t].m(e,o);y(e,t,o),n=!0},p(e,n){98&n&&(r=e[1],re(),s=de(s,n,a,1,e,r,o,t.parentNode,ue,pt,t,lt),ae())},i(e){if(!n){for(let e=0;e<r.length;e+=1)ie(s[e]);n=!0}},o(e){for(let e=0;e<s.length;e+=1)le(s[e]);n=!1},d(e){for(let t=0;t<s.length;t+=1)s[t].d(e);e&&b(t)}}}function pt(e,t){let n,s,o,r,a,i,l,c,u,d,m,h,f=t[16].name+"";function p(){return t[10](t[16])}return o=new it({}),{key:e,first:null,c(){n=v("div"),s=v("div"),me(o.$$.fragment),r=k(),a=v("h3"),i=x(f),l=k(),c=v("button"),c.textContent="Join",u=k(),D(a,"class","room-name svelte-13qkdxs"),D(s,"class","room-title svelte-13qkdxs"),D(c,"class","room-action svelte-13qkdxs"),D(n,"class","room svelte-13qkdxs"),this.first=n},m(e,t){y(e,n,t),$(n,s),he(o,s,null),$(s,r),$(s,a),$(a,i),$(n,l),$(n,c),$(n,u),d=!0,m||(h=I(c,"click",p),m=!0)},p(e,n){t=e,(!d||2&n)&&f!==(f=t[16].name+"")&&S(i,f)},i(e){d||(ie(o.$$.fragment,e),d=!0)},o(e){le(o.$$.fragment,e),d=!1},d(e){e&&b(n),fe(o),m=!1,h()}}}function gt(e){let t;return{c(){t=x("Create Room +")},m(e,n){y(e,t,n)},d(e){e&&b(t)}}}function $t(e){let t,n,s,o,r,a,i,l,c,u,d,m,h,f,p,g,w,M,_,C,j,R,O,E,q;const P=[dt,ut],z=[];function U(e,t){return e[0].length>0?0:1}o=U(e),r=z[o]=P[o](e);const N=[ft,ht],H=[];function A(e,t){return e[1].length>0?0:1}return u=A(e),d=H[u]=N[u](e),R=new Fe({props:{action:e[7],$$slots:{default:[gt]},$$scope:{ctx:e}}}),{c(){t=v("div"),n=v("p"),n.textContent="Joined rooms:",s=k(),r.c(),a=k(),i=v("div"),l=v("p"),l.textContent="Other rooms:",c=k(),d.c(),m=k(),h=v("div"),f=v("div"),p=v("label"),p.textContent="New room name:",g=k(),w=v("input"),M=k(),_=v("p"),C=x(e[4]),j=k(),me(R.$$.fragment),D(n,"class","title"),D(t,"class","joined-rooms"),D(l,"class","title"),D(i,"class","otherRooms"),D(p,"for","room-name"),D(w,"type","text"),D(w,"id","room-name"),D(_,"class","error svelte-13qkdxs"),D(h,"class","new-room svelte-13qkdxs")},m(r,d){y(r,t,d),$(t,n),$(t,s),z[o].m(t,null),y(r,a,d),y(r,i,d),$(i,l),$(i,c),H[u].m(i,null),y(r,m,d),y(r,h,d),$(h,f),$(f,p),$(f,g),$(f,w),T(w,e[3]),$(f,M),$(f,_),$(_,C),$(h,j),he(R,h,null),O=!0,E||(q=I(w,"input",e[11]),E=!0)},p(e,[n]){let s=o;o=U(e),o===s?z[o].p(e,n):(re(),le(z[s],1,1,(()=>{z[s]=null})),ae(),r=z[o],r?r.p(e,n):(r=z[o]=P[o](e),r.c()),ie(r,1),r.m(t,null));let a=u;u=A(e),u===a?H[u].p(e,n):(re(),le(H[a],1,1,(()=>{H[a]=null})),ae(),d=H[u],d?d.p(e,n):(d=H[u]=N[u](e),d.c()),ie(d,1),d.m(i,null)),8&n&&w.value!==e[3]&&T(w,e[3]),(!O||16&n)&&S(C,e[4]);const l={};2097152&n&&(l.$$scope={dirty:n,ctx:e}),R.$set(l)},i(e){O||(ie(r),ie(d),ie(R.$$.fragment,e),O=!0)},o(e){le(r),le(d),le(R.$$.fragment,e),O=!1},d(e){e&&b(t),z[o].d(),e&&b(a),e&&b(i),H[u].d(),e&&b(m),e&&b(h),fe(R),E=!1,q()}}}function yt(e,t,n){let s;i(e,we,(e=>n(5,s=e)));const o=A("client");let r,a=[],l=[],c="",u="";const d=async(e,t)=>{(await o.joinRoom(e,t)).body.message&&f()},m=async e=>{n(2,c=e);const t=await o.getRoom(e);t.body.room?xe.set(t.body.room):xe.set(null)},h=e=>{if(e.body.rooms){const t=[],s=[];for(const n of e.body.rooms)n.joined?t.push(n):s.push(n),console.log(n.id,c);n(0,a=t),n(1,l=s)}},f=async()=>{const e=await o.getRooms();h(e)};let p;U((()=>{p=o.fresh.add(3e3,(()=>o.getRooms()),h)})),N((()=>{p()})),xe.subscribe((()=>f()));return[a,l,c,r,u,s,d,async()=>{const e=await o.createRoom(r);e.body.message?(n(4,u=""),n(3,r="")):n(4,u=e.body.error)},m,e=>m(e.id),e=>d(e.id,s),function(){r=this.value,n(3,r)}]}class bt extends $e{constructor(e){super(),ge(this,e,yt,$t,a,{})}}function vt(t){let n;return{c(){n=v("div"),n.innerHTML="<p>Log in to view rooms...</p>",D(n,"class","login-message svelte-16rt11w")},m(e,t){y(e,n,t)},i:e,o:e,d(e){e&&b(n)}}}function wt(e){let t,n;return t=new bt({}),{c(){me(t.$$.fragment)},m(e,s){he(t,e,s),n=!0},i(e){n||(ie(t.$$.fragment,e),n=!0)},o(e){le(t.$$.fragment,e),n=!1},d(e){fe(t,e)}}}function xt(e){let t,n,s,o;const r=[wt,vt],a=[];function i(e,t){return e[0]?0:1}return n=i(e),s=a[n]=r[n](e),{c(){t=v("aside"),s.c(),D(t,"class","svelte-16rt11w")},m(e,s){y(e,t,s),a[n].m(t,null),o=!0},p(e,[o]){let l=n;n=i(e),n!==l&&(re(),le(a[l],1,1,(()=>{a[l]=null})),ae(),s=a[n],s||(s=a[n]=r[n](e),s.c()),ie(s,1),s.m(t,null))},i(e){o||(ie(s),o=!0)},o(e){le(s),o=!1},d(e){e&&b(t),a[n].d()}}}function kt(e,t,n){let s;return i(e,ve,(e=>n(0,s=e))),[s]}class Mt extends $e{constructor(e){super(),ge(this,e,kt,xt,a,{})}}function It(t){let n,s,o,r,a;return{c(){n=w("svg"),s=w("use"),o=k(),r=w("symbol"),a=w("path"),C(s,"xlink:href","#icon-paper-plane"),D(n,"class","icon icon-paper-plane svelte-1dywkow"),D(a,"d","M27.563 0.172c0.328 0.234 0.484 0.609 0.422 1l-4 24c-0.047 0.297-0.234 0.547-0.5 0.703-0.141 0.078-0.313 0.125-0.484 0.125-0.125 0-0.25-0.031-0.375-0.078l-7.078-2.891-3.781 4.609c-0.187 0.234-0.469 0.359-0.766 0.359-0.109 0-0.234-0.016-0.344-0.063-0.391-0.141-0.656-0.516-0.656-0.938v-5.453l13.5-16.547-16.703 14.453-6.172-2.531c-0.359-0.141-0.594-0.469-0.625-0.859-0.016-0.375 0.172-0.734 0.5-0.922l26-15c0.156-0.094 0.328-0.141 0.5-0.141 0.203 0 0.406 0.063 0.562 0.172z"),D(r,"id","icon-paper-plane"),D(r,"viewBox","0 0 28 28")},m(e,t){y(e,n,t),$(n,s),y(e,o,t),y(e,r,t),$(r,a)},p:e,i:e,o:e,d(e){e&&b(n),e&&b(o),e&&b(r)}}}class _t extends $e{constructor(e){super(),ge(this,e,null,It,a,{})}}const Dt=["Olav","Iselin","Magnus","Mari","Oliver","Tobias"],Ct=["Olav1234","Iselin1234","Magnus1234","Mari1234","Oliver1234","Tobias1234"];var St=()=>{const e=Math.floor(Math.random()*Dt.length);return{username:Dt[e],password:Ct[e]}};const Tt=[["anyone here?","who is here?","how are you doing","i am here!","am I alone here?"],["i have to leave!","i will be back soon","have a nice day, bye!","i have to go"],["I'm listening...","Go on...","Continue","Haha","Same","Try again","I dont understand","Omg!","Bro..."],["hello","hi","hey"],["who are you","your name"],["how are you","how are things"],["what is going on","what is up"],["happy","good","well","fantastic","cool"],["bad","bored","tired","sad"],["story","joke"],["thanks","thank you"],["bye","good bye","goodbye"]],jt=[["Yes, I am here!","For now","I am here, and I am good thanks"],["Ok","See you soon","Text you later","Have a nice day"],["What makes you happy?","Tell a joke"],["Hello!","How are you","Good to see you","Hello there!"],["My name is [username]","I am a bot with username [username]"],["Fine... how are you?","Pretty well, how are you?","Fantastic, how are you?"],["Nothing much","Exciting things!"],["Glad to hear!"],["Why?","Cheer up buddy"],["What about?","Once upon a time...","Don't have time, sorry!"],["You're welcome","You owe me one!","No problem"],["Goodbye","See you later","See you soon"]],Rt=["Anyone here?","Hello","Who is here?","How are you doing","I am here!","Am I alone here?"],Ot=["I have to leave!","I will be back soon","Have a nice day, bye!","I have to go"];var Et=e=>(t,n)=>{if(n)return Ot[Math.floor(Math.random()*Rt.length)];if(!t)return Rt[Math.floor(Math.random()*Rt.length)];return((e,t)=>{for(let t=0;t<Tt.length;t++)for(let n=0;n<Tt[t].length;n++)if(e.includes(Tt[t][n])){let e=jt[t];return e[Math.floor(Math.random()*e.length)]}return null})(t.message.toLowerCase()).replace("[username]",e)};class qt{client;options;username;password;roomID;userID;loopID;mastermind;unresponsive=0;messages=[{sender:"",message:""}];messageSentCounter=0;numberOfMessages;lastMessage={sender:"",message:""};lastMessageTime;constructor(e,t){let{username:n,password:s}=St();t.name&&(n=t.name),this.client=e,this.options=t||{},this.username=n,this.password=s,this.numberOfMessages=Math.floor(21*Math.random()+10),this.mastermind=Et(this.username)}async start(){let e=await this.client.registerBot(this.username,this.password);if("User created"!==e.body.message||(e=await this.client.login(this.username,this.password),"Logged in"!==e.body.message))this.shutdown();else{this.userID=this.client.state.get().userID;try{await this.joinRoom()}catch(e){return void this.shutdown()}this.loop()}}async joinRoom(){const e=this.options.room?this.options.room:"Botroom";let t=await this.client.getRooms();for(const n of t.body.rooms)if(n.name===e)return await this.client.joinRoom(n.id,this.userID),void(this.roomID=n.id);await this.client.createRoom(e),t=await this.client.getRooms();for(const n of t.body.rooms)if(n.name===e)return this.roomID=n.id,void(this.admin=!0)}loop(){const e=this.client.fresh.add(1e3,(()=>this.client.getMessages(this.roomID)),this.updateMessages,this.shutdown);this.lastMessageTime=Date.now(),this.sendDelay(this.mastermind());const t=setInterval((()=>{const n=this.messages[this.messages.length-1]||{sender:"",message:""};if(this.lastMessage.message!==n.message&&n.sender!==this.username){if(this.messageSentCounter===this.numberOfMessages)return void this.shutdown(e,t);this.lastMessageTime=Date.now(),this.lastMessage=n,this.sendDelay(this.mastermind(n,!1))}else if(Date.now()-this.lastMessageTime>3e4){if(this.unresponsive+=1,2===this.unresponsive)return void this.shutdown();this.sendDelay(this.mastermind("",!1)),this.lastMessageTime=Date.now()}}),500);this.stopFresh=e,this.loopID=t}shutdown=async e=>{this.loopID&&clearInterval(this.loopID),this.stopFresh&&this.stopFresh(),"server down"!==e&&(this.roomID&&this.send(this.mastermind("",!0)),this.admin?this.logout():this.deregister())};updateMessages=e=>{this.messages=e.body.messages};send(e){this.messageSentCounter+=1;(async()=>{(await this.client.postMessage(this.roomID,this.userID,e)).body.error&&this.shutdown("server down")})()}sendDelay(e){let t=Math.floor(8*Math.random()+3);setTimeout((()=>{this.send(e)}),t)}async deregister(){await this.client.deleteUser(this.userID)}async logout(){await this.client.logout(this.client.state.get().token)}}function Pt(e){let t,n,s,o,r,a=(e[0]?e[0]:"bot")+"",i=e[2].name+"";return{c(){t=x("Add "),n=x(a),s=x(" to "),o=x(i),r=x(" +")},m(e,a){y(e,t,a),y(e,n,a),y(e,s,a),y(e,o,a),y(e,r,a)},p(e,t){1&t&&a!==(a=(e[0]?e[0]:"bot")+"")&&S(n,a),4&t&&i!==(i=e[2].name+"")&&S(o,i)},d(e){e&&b(t),e&&b(n),e&&b(s),e&&b(o),e&&b(r)}}}function zt(e){let t,n,s,o,r,a,i,l,c,u,d,m,h;return u=new Fe({props:{action:e[3],$$slots:{default:[Pt]},$$scope:{ctx:e}}}),{c(){t=v("div"),n=v("div"),s=v("label"),s.textContent="New bot name:",o=k(),r=v("input"),a=k(),i=v("p"),l=x(e[1]),c=k(),me(u.$$.fragment),D(s,"for","room-name"),D(r,"type","text"),D(r,"id","room-name"),D(i,"class","error svelte-9qzgh7"),D(t,"class","add-bot svelte-9qzgh7")},m(f,p){y(f,t,p),$(t,n),$(n,s),$(n,o),$(n,r),T(r,e[0]),$(n,a),$(n,i),$(i,l),$(t,c),he(u,t,null),d=!0,m||(h=I(r,"input",e[5]),m=!0)},p(e,[t]){1&t&&r.value!==e[0]&&T(r,e[0]),(!d||2&t)&&S(l,e[1]);const n={};517&t&&(n.$$scope={dirty:t,ctx:e}),u.$set(n)},i(e){d||(ie(u.$$.fragment,e),d=!0)},o(e){le(u.$$.fragment,e),d=!1},d(e){e&&b(t),fe(u),m=!1,h()}}}function Ut(e,t,n){let s;i(e,xe,(e=>n(2,s=e)));let{room:o}=t;const r=A("host"),a=A("port"),l=A("client");let c="",u="";return e.$$set=e=>{"room"in e&&n(4,o=e.room)},[c,u,s,async()=>{const e=await l.getUsers();if(e.body.users){if(!c||c.length<3)return void n(1,u="Name must be 3 characters or longer");for(const t of e.body.users)if(t.username===c)return void n(1,u="A bot or user with that name allready exists")}((e,t)=>new qt(e,t))(Pe({host:r,port:a}),{room:o,name:c}).start(),n(1,u=""),n(0,c="")},o,function(){c=this.value,n(0,c)}]}class Nt extends $e{constructor(e){super(),ge(this,e,Ut,zt,a,{room:4})}}function Ht(t){let n,s,o,r,a;return{c(){n=w("svg"),s=w("use"),o=k(),r=w("symbol"),a=w("path"),C(s,"xlink:href","#icon-user"),D(n,"class","icon icon-user svelte-8idrmo"),D(a,"d","M18 22.082v-1.649c2.203-1.241 4-4.337 4-7.432 0-4.971 0-9-6-9s-6 4.029-6 9c0 3.096 1.797 6.191 4 7.432v1.649c-6.784 0.555-12 3.888-12 7.918h28c0-4.030-5.216-7.364-12-7.918z"),D(r,"id","icon-user"),D(r,"viewBox","0 0 32 32")},m(e,t){y(e,n,t),$(n,s),y(e,o,t),y(e,r,t),$(r,a)},p:e,i:e,o:e,d(e){e&&b(n),e&&b(o),e&&b(r)}}}class At extends $e{constructor(e){super(),ge(this,e,null,Ht,a,{})}}function Lt(t){let n,s,o,r,a;return{c(){n=w("svg"),s=w("use"),o=k(),r=w("symbol"),a=w("path"),C(s,"xlink:href","#icon-f-droid"),D(n,"class","icon icon-f-droid svelte-8idrmo"),D(a,"d","M27.296 13.441h-22.592c-1.169 0-2.119 0.948-2.119 2.119v14.12c0 1.169 0.948 2.119 2.119 2.119h22.592c1.169 0 2.119-0.948 2.119-2.119v-14.12c0-1.171-0.949-2.119-2.119-2.119zM16 30.033c-4.088 0-7.413-3.325-7.413-7.413s3.325-7.413 7.413-7.413 7.413 3.325 7.413 7.413-3.325 7.413-7.413 7.413zM16 16.548c-3.348 0-6.072 2.724-6.072 6.072s2.724 6.072 6.072 6.072 6.072-2.724 6.072-6.072-2.724-6.072-6.072-6.072zM16 27.032c-2.084 0-3.841-1.471-4.295-3.424h2.227c0.367 0.775 1.145 1.305 2.068 1.305 1.28 0 2.295-1.015 2.295-2.295s-1.015-2.295-2.295-2.295c-0.865 0-1.6 0.469-1.991 1.165h-2.269c0.504-1.883 2.225-3.283 4.26-3.283 2.424 0 4.412 1.988 4.412 4.412 0 2.425-1.988 4.413-4.412 4.413zM31.799 0.528c-0.001 0.001-0.003 0.003-0.003 0.004-0.003-0.003-0.005-0.004-0.008-0.007 0.001-0.001 0.003-0.004 0.005-0.005-0.155-0.183-0.372-0.308-0.692-0.317-0.269 0.007-0.521 0.129-0.683 0.345l-2.424 3.137c-0.219-0.077-0.452-0.127-0.697-0.127h-22.593c-0.245 0-0.477 0.051-0.697 0.127l-2.424-3.139c-0.161-0.216-0.413-0.337-0.683-0.345-0.32 0.008-0.537 0.133-0.692 0.317 0.001 0.001 0.003 0.004 0.005 0.005-0.004 0.003-0.007 0.005-0.009 0.008 0-0.001-0.001-0.003-0.003-0.004-0.088 0.104-0.396 0.568-0.016 1.099l2.545 3.295c-0.089 0.235-0.144 0.488-0.144 0.755v4.943c0 1.169 0.948 2.119 2.119 2.119h22.592c1.169 0 2.119-0.948 2.119-2.119v-4.943c0-0.267-0.055-0.52-0.145-0.755l2.545-3.295c0.379-0.531 0.071-0.995-0.017-1.099zM9.205 10.971c-1.316 0-2.383-1.067-2.383-2.383s1.067-2.383 2.383-2.383 2.383 1.067 2.383 2.383-1.067 2.383-2.383 2.383zM22.972 10.971c-1.316 0-2.383-1.067-2.383-2.383s1.067-2.383 2.383-2.383 2.383 1.067 2.383 2.383-1.067 2.383-2.383 2.383z"),D(r,"id","icon-f-droid"),D(r,"viewBox","0 0 32 32")},m(e,t){y(e,n,t),$(n,s),y(e,o,t),y(e,r,t),$(r,a)},p:e,i:e,o:e,d(e){e&&b(n),e&&b(o),e&&b(r)}}}class Bt extends $e{constructor(e){super(),ge(this,e,null,Lt,a,{})}}function Ft(e,t,n){const s=e.slice();return s[8]=t[n],s}function Wt(e){let t,n;return t=new At({}),{c(){me(t.$$.fragment)},m(e,s){he(t,e,s),n=!0},i(e){n||(ie(t.$$.fragment,e),n=!0)},o(e){le(t.$$.fragment,e),n=!1},d(e){fe(t,e)}}}function Gt(e){let t,n;return t=new Bt({}),{c(){me(t.$$.fragment)},m(e,s){he(t,e,s),n=!0},i(e){n||(ie(t.$$.fragment,e),n=!0)},o(e){le(t.$$.fragment,e),n=!1},d(e){fe(t,e)}}}function Jt(e){let t;return{c(){t=v("p"),t.textContent="(you)",D(t,"class","admin svelte-1chyo9m")},m(e,n){y(e,t,n)},d(e){e&&b(t)}}}function Yt(e){let t;return{c(){t=v("p"),t.textContent="(admin)",D(t,"class","admin svelte-1chyo9m")},m(e,n){y(e,t,n)},d(e){e&&b(t)}}}function Kt(e){let t;return{c(){t=v("p"),t.textContent="(admin/you)",D(t,"class","admin svelte-1chyo9m")},m(e,n){y(e,t,n)},d(e){e&&b(t)}}}function Qt(e,t){let n,s,o,r,a,i,l,c,u,d,m,h,f=t[8].username+"";const p=[Gt,Wt],g=[];function w(e,t){return e[8].bot?0:1}function M(e,t){return(null==u||3&t)&&(u=!(e[8].id!==e[1].admin||e[8].id!==e[2].state.get().userID)),u?Kt:e[8].id===e[1].admin?Yt:((null==d||1&t)&&(d=!(e[8].id!==e[2].state.get().userID)),d?Jt:void 0)}o=w(t),r=g[o]=p[o](t);let I=M(t,-1),_=I&&I(t);return{key:e,first:null,c(){n=v("li"),s=v("div"),r.c(),a=k(),i=v("p"),l=x(f),c=k(),_&&_.c(),m=k(),D(s,"class","user-name svelte-1chyo9m"),D(n,"class","svelte-1chyo9m"),this.first=n},m(e,t){y(e,n,t),$(n,s),g[o].m(s,null),$(s,a),$(s,i),$(i,l),$(n,c),_&&_.m(n,null),$(n,m),h=!0},p(e,i){let c=o;o=w(t=e),o!==c&&(re(),le(g[c],1,1,(()=>{g[c]=null})),ae(),r=g[o],r||(r=g[o]=p[o](t),r.c()),ie(r,1),r.m(s,a)),(!h||1&i)&&f!==(f=t[8].username+"")&&S(l,f),I!==(I=M(t,i))&&(_&&_.d(1),_=I&&I(t),_&&(_.c(),_.m(n,m)))},i(e){h||(ie(r),h=!0)},o(e){le(r),h=!1},d(e){e&&b(n),g[o].d(),_&&_.d()}}}function Vt(e){let t,n,s=[],o=new Map,r=e[0];const a=e=>e[8].id;for(let t=0;t<r.length;t+=1){let n=Ft(e,r,t),i=a(n);o.set(i,s[t]=Qt(i,n))}return{c(){t=v("ul");for(let e=0;e<s.length;e+=1)s[e].c();D(t,"class","svelte-1chyo9m")},m(e,o){y(e,t,o);for(let e=0;e<s.length;e+=1)s[e].m(t,null);n=!0},p(e,[n]){7&n&&(r=e[0],re(),s=de(s,n,a,1,e,r,o,t,ue,Qt,null,Ft),ae())},i(e){if(!n){for(let e=0;e<r.length;e+=1)ie(s[e]);n=!0}},o(e){for(let e=0;e<s.length;e+=1)le(s[e]);n=!1},d(e){e&&b(t);for(let e=0;e<s.length;e+=1)s[e].d()}}}function Xt(e,t,n){let s;i(e,xe,(e=>n(1,s=e)));const o=A("client");let r,a=[];const l=e=>{e.body.users&&n(0,a=e.body.users)},c=async()=>{if(s){const e=await o.getUsersInRoom(s.id);l(e)}};U((()=>{c(),(async()=>{r=o.fresh.add(3e3,(()=>o.getUsersInRoom(s.id)),l)})()}));const u=xe.subscribe((e=>c()));return N((()=>{r(),u()})),[a,s,o]}class Zt extends $e{constructor(e){super(),ge(this,e,Xt,Vt,a,{})}}function en(e,t,n){const s=e.slice();return s[16]=t[n],s}function tn(e){let t,n,s,o,r,a,i,l,c,u=e[16].sender+"",d=e[16].message+"";return{c(){t=v("div"),n=v("p"),s=x(u),o=x(":"),r=k(),a=v("div"),i=v("p"),l=x(d),c=k(),D(n,"class","author svelte-82a05y"),D(i,"class","message-text svelte-82a05y"),D(a,"class","message-bubble svelte-82a05y"),D(t,"class","message svelte-82a05y")},m(e,u){y(e,t,u),$(t,n),$(n,s),$(n,o),$(t,r),$(t,a),$(a,i),$(i,l),$(t,c)},p(e,t){1&t&&u!==(u=e[16].sender+"")&&S(s,u),1&t&&d!==(d=e[16].message+"")&&S(l,d)},d(e){e&&b(t)}}}function nn(e){let t,n,s,o,r;return o=new Fe({props:{color:"red",action:e[6],$$slots:{default:[sn]},$$scope:{ctx:e}}}),{c(){t=v("div"),n=v("p"),n.textContent="Admin actions:",s=k(),me(o.$$.fragment),D(t,"class","admin-actions svelte-82a05y")},m(e,a){y(e,t,a),$(t,n),$(t,s),he(o,t,null),r=!0},p(e,t){const n={};524288&t&&(n.$$scope={dirty:t,ctx:e}),o.$set(n)},i(e){r||(ie(o.$$.fragment,e),r=!0)},o(e){le(o.$$.fragment,e),r=!1},d(e){e&&b(t),fe(o)}}}function sn(e){let t;return{c(){t=x("Delete room")},m(e,n){y(e,t,n)},d(e){e&&b(t)}}}function on(e){let t,n,s,r,a,i,l,c,u,d,m,h,f,p,g,w,x,M,_,C,S,j,R=e[0],O=[];for(let t=0;t<R.length;t+=1)O[t]=tn(en(e,R,t));u=new _t({});let E=e[3].admin===e[4]&&nn(e);return x=new Zt({}),_=new Nt({props:{room:e[3].name}}),{c(){t=v("div"),n=v("div"),s=v("div");for(let e=0;e<O.length;e+=1)O[e].c();r=k(),a=v("div"),i=v("input"),l=k(),c=v("button"),me(u.$$.fragment),m=k(),h=v("div"),E&&E.c(),f=k(),p=v("div"),g=v("p"),g.textContent="Users in room:",w=k(),me(x.$$.fragment),M=k(),me(_.$$.fragment),D(s,"class","feed svelte-82a05y"),D(i,"class","input-box svelte-82a05y"),D(i,"placeholder","type message..."),D(i,"type","text"),D(i,"rows","3"),c.disabled=d=0===e[1].length,D(c,"class","send-button svelte-82a05y"),D(a,"class","message-input svelte-82a05y"),D(n,"class","chat svelte-82a05y"),D(h,"class","metadata svelte-82a05y"),D(t,"class","room svelte-82a05y")},m(o,d){y(o,t,d),$(t,n),$(n,s);for(let e=0;e<O.length;e+=1)O[e].m(s,null);e[7](s),$(n,r),$(n,a),$(a,i),T(i,e[1]),$(a,l),$(a,c),he(u,c,null),$(t,m),$(t,h),E&&E.m(h,null),$(h,f),$(h,p),$(p,g),$(p,w),he(x,p,null),$(h,M),he(_,h,null),C=!0,S||(j=[I(i,"keydown",e[8]),I(i,"input",e[9]),I(c,"click",e[5])],S=!0)},p(e,[t]){if(1&t){let n;for(R=e[0],n=0;n<R.length;n+=1){const o=en(e,R,n);O[n]?O[n].p(o,t):(O[n]=tn(o),O[n].c(),O[n].m(s,null))}for(;n<O.length;n+=1)O[n].d(1);O.length=R.length}2&t&&i.value!==e[1]&&T(i,e[1]),(!C||2&t&&d!==(d=0===e[1].length))&&(c.disabled=d),e[3].admin===e[4]?E?(E.p(e,t),24&t&&ie(E,1)):(E=nn(e),E.c(),ie(E,1),E.m(h,f)):E&&(re(),le(E,1,1,(()=>{E=null})),ae());const n={};8&t&&(n.room=e[3].name),_.$set(n)},i(e){C||(ie(u.$$.fragment,e),ie(E),ie(x.$$.fragment,e),ie(_.$$.fragment,e),C=!0)},o(e){le(u.$$.fragment,e),le(E),le(x.$$.fragment,e),le(_.$$.fragment,e),C=!1},d(n){n&&b(t),function(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}(O,n),e[7](null),fe(u),E&&E.d(),fe(x),fe(_),S=!1,o(j)}}}function rn(e,t,n){let s,o;i(e,xe,(e=>n(3,s=e))),i(e,we,(e=>n(4,o=e)));let r,a,l=[],c="",u=A("client");const d=e=>{e.body.messages&&n(0,l=e.body.messages);let t=20;for(const e of a.children)t+=e.clientHeight,t+=20;setTimeout((()=>n(2,a.scrollTop=t,a)),50)},m=async()=>{if(s){const e=await u.getMessages(s.id);d(e)}},h=async()=>{if(!c)return;(await u.postMessage(s.id,o,c)).body.message&&n(1,c="")};U((()=>{m(),(async()=>{r=u.fresh.add(3e3,(()=>u.getMessages(s.id)),d)})()}));const f=xe.subscribe((e=>{m()}));N((()=>{r(),f()}));return[l,c,a,s,o,h,async()=>{(await u.deleteRoom(s.id)).body.message&&function(e,t,n=t){e.set(n)}(xe,s=null,s)},function(e){F[e?"unshift":"push"]((()=>{a=e,n(2,a)}))},e=>{13===e.keyCode&&h()},function(){c=this.value,n(1,c)}]}class an extends $e{constructor(e){super(),ge(this,e,rn,on,a,{})}}function ln(t){let n;return{c(){n=v("div"),n.innerHTML='<h1>Welcome!</h1> \n        <div><p class="sub svelte-9n71tp">This is a chat room for humans and bots :)</p> \n            <p class="sub svelte-9n71tp">Register or login to access the chat rooms.</p></div>',D(n,"class","welcome-box svelte-9n71tp")},m(e,t){y(e,n,t)},i:e,o:e,d(e){e&&b(n)}}}function cn(e){let t,n;return t=new an({}),{c(){me(t.$$.fragment)},m(e,s){he(t,e,s),n=!0},i(e){n||(ie(t.$$.fragment,e),n=!0)},o(e){le(t.$$.fragment,e),n=!1},d(e){fe(t,e)}}}function un(e){let t,n,s,o;const r=[cn,ln],a=[];function i(e,t){return e[0]?0:1}return t=i(e),n=a[t]=r[t](e),{c(){n.c(),s=M()},m(e,n){a[t].m(e,n),y(e,s,n),o=!0},p(e,[o]){let l=t;t=i(e),t!==l&&(re(),le(a[l],1,1,(()=>{a[l]=null})),ae(),n=a[t],n||(n=a[t]=r[t](e),n.c()),ie(n,1),n.m(s.parentNode,s))},i(e){o||(ie(n),o=!0)},o(e){le(n),o=!1},d(e){a[t].d(e),e&&b(s)}}}function dn(e,t,n){let s;return i(e,xe,(e=>n(0,s=e))),[s]}class mn extends $e{constructor(e){super(),ge(this,e,dn,un,a,{})}}function hn(t){let n,s,o,r,a,i,l,c;return n=new rt({}),r=new Mt({}),l=new mn({}),{c(){me(n.$$.fragment),s=k(),o=v("div"),me(r.$$.fragment),a=k(),i=v("main"),me(l.$$.fragment),D(i,"class","svelte-1tdyujj"),D(o,"class","content svelte-1tdyujj")},m(e,t){he(n,e,t),y(e,s,t),y(e,o,t),he(r,o,null),$(o,a),$(o,i),he(l,i,null),c=!0},p:e,i(e){c||(ie(n.$$.fragment,e),ie(r.$$.fragment,e),ie(l.$$.fragment,e),c=!0)},o(e){le(n.$$.fragment,e),le(r.$$.fragment,e),le(l.$$.fragment,e),c=!1},d(e){fe(n,e),e&&b(s),e&&b(o),fe(r),fe(l)}}}function fn(e,t,n){let s,o;i(e,ve,(e=>n(1,s=e))),i(e,we,(e=>n(2,o=e)));let r=window.location.hostname,a=window.location.port;const l=Pe({host:r,port:a});let c;return H("client",l),H("host",r),H("port",a),s&&l.state.update({token:s}),o&&l.state.update({userID:o}),U((()=>{c=l.state.subscribe((e=>{e.token&&"string"==typeof e.token?ve.set(e.token):(ve.set(""),xe.set(null)),e.userID&&"string"==typeof e.userID?we.set(e.userID):we.set("")}))})),N((()=>{c()})),[]}return new class extends $e{constructor(e){super(),ge(this,e,fn,hn,a,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
